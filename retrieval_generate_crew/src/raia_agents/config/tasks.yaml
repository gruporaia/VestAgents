melhorar_pergunta:
  description: >
    Melhora a pergunta do usuário, tornando-a mais clara para obter melhores respostas de ferramentas de IA.
    Deve manter o significado original da pergunta, sem acrescentar pedidos adicionais, mas melhorar a clareza e a precisão.
    Input do usuário: {input_user}
  expected_output: >
    Um json com as chaves "pergunta_original", "pergunta_melhorada" preenchidas com os valores correspondentes.
    Exemplo de saída:
    {
      "pergunta_original": "eu quero uma questão de química pra entrar na unicamp sobre Funções estruturas e ligações em quimica organica",
      "pergunta_melhorada": "Crie uma questão de múltipla escolha no estilo do vestibular da Unicamp sobre funções orgânicas, estrutura molecular e tipos de ligações em compostos orgânicos. A questão deve ter nível de dificuldade médio e incluir alternativas plausíveis, com gabarito e explicação comentada."
    }

  agent: melhorador_perguntas


filtrar_topicos:
  description: >
    Identifique a universidade, a disciplina, categoria e a subcategoria da questão já melhorada pelo agente anterior.

  expected_output: >
    Um json com as chaves "disciplina", "categoria" e "subcategoria" preenchidas com os valores correspondentes.
    Exemplo de saída:
    {
      "universidade": "Unicamp",
      "disciplina": "Física",
      "categoria": "Mecânica",
      "subcategoria": "Cinemática"
    }

  agent: identificador_topicos

verificação_ferramenta:
  description: >
    Use a tool para gerar sua resposta. Considere utilizar uma quantidade de cerca de 4 trechos de similaridade para a tool.
    Verifique se a ferramenta retornou perguntas de vestibulares coerentes com o pedido na requisição do aluno.
    Caso contrário, faça uma solicitação para que o usuário reformule a pergunta original.
  expected_output: >
    Um json com a chave "perguntas" preenchidas com os valores correspondentes das perguntas mais adequadas ao contexto.
    As perguntas são objetos (Document(id='deaa3751-fe8c-4dd8-a82f-a3743afc816d', metadata={'question_id': 36673, 'source': 'info.csv', 'subject': 'Física', 'university': 'UFPR', 'metadata': {'file_name': 'info.csv', 'file_type': '.csv', 'file_size': 25114068}}, page_content='Enunciado'), np.float32(0.3204196))
    Exemplo de saída:
    {
      "perguntas": [
        {
          "question_id": 36673,
          "source": "info.csv",
          "subject": "Física",
          "university": "UFPR",
          "metadata": {
            "file_name": "info.csv",
            "file_type": ".csv",
            "file_size": 25114068
          },
          "page_content": "Enunciado",
          "score": 0.3204196
        }
      ]
    }
  agent: redator_questao

geração_questao:
  description: >
    Gere uma questão inédita de múltipla escolha para vestibulares e ENEM, com base em um tópico, categoria e subcategoria fornecidos.
    A questão deve ser elaborada no estilo dos principais exames brasileiros (como ENEM), focando na avaliação de competências essenciais do ensino médio.

    Instruções Detalhadas:

    1. Estrutura da Questão:
      Enunciado: Deve ser autocontido, apresentando uma contextualização relevante e instigante (podendo ser um cenário 
      cotidiano, científico, histórico, social, etc.), seguida de uma pergunta principal clara e objetiva. O enunciado 
      deve ter entre 50 e 200 palavras.
      Alternativas: Crie 4 (quatro) alternativas de resposta, rotuladas como A, B, C, D.
    2. Qualidade das Alternativas:
      Correta: Apenas UMA alternativa deve ser inequivocamente correta, com base nos conhecimentos esperados para o 
      nível.
      Distratores: As outras três alternativas (distratores) devem ser plausíveis e atraentes, mas tecnicamente 
      incorretas. Idealmente, os distratores devem explorar erros conceituais comuns, interpretações parciais, 
      raciocínios falhos ou aplicação incorreta de fórmulas/conceitos. Evite alternativas absurdas ou facilmente 
      descartáveis.
    3. Conteúdo e Competências:
      A questão deve ser rigorosamente precisa em termos conceituais e factuais para o tópico fornecido.
      Deve avaliar habilidades cognitivas além da simples memorização, como interpretação de texto/dados, análise 
      crítica, raciocínio lógico, argumentação, resolução de problemas e aplicação de conhecimentos em novos contextos.
    4. Formato e Estilo:
      Utilize linguagem clara, precisa e adequada ao público do ensino médio e pré-vestibular.
      Se a questão envolver fórmulas matemáticas, gráficos, tabelas ou equações químicas, utilize a notação LaTeX 
      para representá-las corretamente. 
      A questão deve ser original, evitando cópias diretas de questões existentes, mas pode se inspirar na complexidade,
       no formato e no estilo de questões de exames anteriores.
    5. Restrições:
      Não inclua a identificação da resposta correta (gabarito) no texto do enunciado ou das alternativas. O gabarito 
      será especificado em um campo separado no JSON de saída.
      Não utilize as tools disponíveis para esta tarefa. A geração deve ser baseada exclusivamente no seu conhecimento 
      e nas instruções fornecidas.
      A questão deve ser solucionável com base no conhecimento tipicamente adquirido durante o Ensino Médio.
  expected_output: >
    Um objeto JSON contendo as chaves "enunciado", "alternativas" e "gabarito".
    A chave "alternativas" deve ser um objeto com as chaves "A", "B", "C", "D", contendo os textos de cada alternativa.
    A chave "gabarito" deve conter a letra da alternativa correta.

    Exemplo de Saída:Exemplo de saída:
    {
          "enunciado": "Um jardineiro dispõe de k metros lineares de cerca baixa para fazer um jardim ornamental. O jardim, delimitado por essa cerca, deve ter a forma de um triângulo equilátero, um quadrado ou um hexágono regular. A escolha será pela forma que resulte na maior área. O jardineiro escolherá a forma de",
          "alternativas": {
            "A": "hexágono regular, pois a área do jardim, em metro quadrado, será $\frac{k^2\sqrt{3}}{24}$.",
            "B": "hexágono regular, pois a área do jardim, em metro quadrado, será $\frac{3k^2\sqrt{3}}{2}$.",
            "C": "quadrado, pois a área do jardim, em metro quadrado, será $\frac{k^2}{16}$.",
            "D": "triângulo equilátero, pois a área do jardim, em metro quadrado, será $\frac{k^2\sqrt{3}}{36}$."
      }
  agent: redator_questao


resolucao_questao:
  description: >
    Solucione a questão de vestibular gerada previamente e explique o raciocínio por trás da resolução.
    Desenvolva a lógica de raciocínio e o embasamento teórico que fundamenta a resposta correta.
    Destaque a resposta final e alternativa correta entre as opções apresentadas. Se não houver uma alternativa correta, indique que a questão não possui uma resposta correta.
  expected_output: >
    Um json com as chaves "explicacao", "resposta_final" e "alternativa_correta" preenchidas com os valores correspondentes.
    Exemplo de saída:
    {
      "explicacao": "A velocidade média é dada pela fórmula V = d/t, onde d é a distância e t é o tempo. Neste caso, d = 100 km e t = 2 h. Portanto, V = 100 km / 2 h = 50 km/h.",
      "resposta_final": "50 km/h",
      "alternativa_correta": "A"
    }
  agent: resolutor_questao

correção_questao:
  description: >
    Analise criticamente e corrija exclusivamente o enunciado de uma questão de vestibular previamente gerada.
    Input: Você receberá uma questão completa (com "enunciado" original, "alternativas" e "gabarito").
    Sua Tarefa:

    1. Identifique e corrija erros de gramática (ortografia, concordância, regência, pontuação), imprecisões na 
    fundamentação teórica, ambiguidades, falta de clareza ou informações redundantes/ausentes no enunciado.
    2.  NÃO altere as "alternativas" nem o "gabarito" fornecidos. Seu trabalho é ajustar o enunciado para que ele 
    esteja correto, claro e totalmente alinhado com as alternativas e o gabarito existentes.
    3. As correções devem visar a melhoria da qualidade e da precisão do enunciado, sem modificar o problema central 
    proposto ou o nível de dificuldade pretendido.
    4. No campo "correcoes_detalhadas" do JSON de saída, descreva objetivamente todas as alterações significativas 
    realizadas no enunciado e justifique brevemente por que foram necessárias (ex: "Correção de concordância verbal na 
    segunda frase para maior clareza.", "Ajuste na definição de X para precisão conceitual.", "Remoção de informação 
    redundante que não contribuía para a pergunta.").
    5. Se o enunciado original já estiver perfeito e não necessitar de correções, indique isso claramente no campo 
    "correcoes_detalhadas" (ex: "Nenhuma correção necessária. O enunciado original está gramaticalmente correto, 
    conceitualmente preciso e claro.").
  expected_output: >
    Um json sem ``` com as chaves "enunciado", "alternativas" e "correcoes" preenchidas com os valores correspondentes.
    Exemplo de saída:

      {
          "enunciado": "Um jardineiro dispõe de k metros lineares de cerca baixa para fazer um jardim ornamental. O jardim, delimitado por essa cerca, deve ter a forma de um triângulo equilátero, um quadrado ou um hexágono regular. A escolha será pela forma que resulte na maior área. O jardineiro escolherá a forma de",
          "alternativas_originais": {
            "A": "hexágono regular, pois a área do jardim, em metro quadrado, será $\frac{k^2\sqrt{3}}{24}$.",
            "B": "hexágono regular, pois a área do jardim, em metro quadrado, será $\frac{3k^2\sqrt{3}}{2}$.",
            "C": "quadrado, pois a área do jardim, em metro quadrado, será $\frac{k^2}{16}$.",
            "D": "triângulo equilátero, pois a área do jardim, em metro quadrado, será $\frac{k^2\sqrt{3}}{36}$.",
          "gabarito_original" : "A",
          "correcao": "A correção realizada foi em ...."
      }
  agent: revisor_questao